-- ===== Services =====
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local PhysicsService = game:GetService("PhysicsService")

local player = Players.LocalPlayer
local char = player.Character or player.CharacterAdded:Wait()
local root = char:WaitForChild("HumanoidRootPart")
local playerGui = player:WaitForChild("PlayerGui")

-- ===== UI =====
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "FloatUI"
screenGui.ResetOnSpawn = false
screenGui.Parent = playerGui

local button = Instance.new("TextButton")
button.Size = UDim2.new(0, 120, 0, 40)
button.Position = UDim2.new(0.5, -60, 0.8, 0)
button.Text = "Float"
button.BackgroundColor3 = Color3.fromRGB(100, 200, 255)
button.TextColor3 = Color3.fromRGB(0, 0, 0)
button.Parent = screenGui


-- ===== Settings =====
local FLOAT_HEIGHT = 100  -- สูงขึ้นจากตำแหน่งเริ่ม
local RISE_TIME = 8      -- เวลาลอยขึ้น
local OFFSET_BELOW = 3    -- ต่ำกว่าเท้านิดเดียว
local floatPart
local liftActive = false

-- ===== Function =====
local function spawnLift()
	if floatPart then floatPart:Destroy() end

	-- สร้างแผ่นใหญ่
	floatPart = Instance.new("Part")
	floatPart.Size = Vector3.new(10, 2, 10)
	floatPart.Anchored = false
	floatPart.CanCollide = true
	floatPart.Position = root.Position - Vector3.new(0, OFFSET_BELOW, 0)
	floatPart.Rotation = Vector3.new(0,0,0)
	floatPart.Parent = workspace

	-- ใส่ CollisionGroup
	PhysicsService:SetPartCollisionGroup(floatPart, "Float")

	-- ใช้ BodyPosition เพื่อเคลื่อนแผ่น
	local bp = Instance.new("BodyPosition")
	bp.MaxForce = Vector3.new(1e6,1e6,1e6)
	bp.P = 5000
	bp.D = 100
	bp.Position = floatPart.Position
	bp.Parent = floatPart

	-- ใช้ BodyGyro ล็อคแผ่นแนวนอน
	local bg = Instance.new("BodyGyro")
	bg.MaxTorque = Vector3.new(1e6,1e6,1e6)
	bg.P = 5000
	bg.CFrame = CFrame.new(floatPart.Position)
	bg.Parent = floatPart

	liftActive = true
	local startTime = tick()
	local startPos = floatPart.Position
	local endPos = startPos + Vector3.new(0, FLOAT_HEIGHT, 0)

	-- อัปเดตตำแหน่งต่อเนื่อง
	local conn
	conn = RunService.Heartbeat:Connect(function(dt)
		if not liftActive then
			conn:Disconnect()
			bp:Destroy()
			bg:Destroy()
			return
		end
		local alpha = math.clamp((tick() - startTime)/RISE_TIME, 0, 1)
		bp.Position = startPos:Lerp(endPos, alpha)
		bg.CFrame = CFrame.new(bp.Position)

		if alpha >= 1 then
			conn:Disconnect()
			bp:Destroy()
			bg:Destroy()
		end
	end)

	-- ลบตัวเองหลัง 5 วินาที
	task.delay(10, function()
		if floatPart then
			floatPart:Destroy()
			floatPart = nil
			liftActive = false
		end
	end)
end

button.MouseButton1Click:Connect(spawnLift)
